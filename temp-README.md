// ì œì¶œ ì „ ì„ì‹œ README
# ğŸš€ ì¡°íšŒ ì„±ëŠ¥ ê°œì„ í•˜ê¸°

> ë¯¸ì…˜ ìš”êµ¬ì‚¬í•­ì€ A, Bë§Œ í•´ë‹¹ë˜ì–´ì„œ ë“¤ì–´ê°€ê¸°ì— ì•ì„œëŠ” ì•ˆë³´ì…”ë„ ë˜êµ¬ ë³´ì…”ë„ ë˜êµ¬ ììœ ì…ë‹ˆë‹¹ !!

## ëª©ì°¨
* [ë“¤ì–´ê°€ê¸°ì— ì•ì„œ](#ë“¤ì–´ê°€ê¸°ì—-ì•ì„œ)
    * [1ë²ˆ](#ì‹¤ìŠµ-1ë²ˆ)
    * [2ë²ˆ](#ì‹¤ìŠµ-2ë²ˆ)
    * [3ë²ˆ](#ì‹¤ìŠµ-3ë²ˆ)
* [A. ì¿¼ë¦¬ ì—°ìŠµ](#a-ì¿¼ë¦¬-ì—°ìŠµ)
  * [A1 - ì¿¼ë¦¬ ì‘ì„±ë§Œìœ¼ë¡œ 1s ì´í•˜ë¡œ ë°˜í™˜í•œë‹¤.](#a1---ì¿¼ë¦¬-ì‘ì„±ë§Œìœ¼ë¡œ-1s-ì´í•˜ë¡œ-ë°˜í™˜í•œë‹¤)
  * [A2 - ì¸ë±ìŠ¤ ì„¤ì •ì„ ì¶”ê°€í•˜ì—¬ 50 ms ì´í•˜ë¡œ ë°˜í™˜í•œë‹¤.](#a2---ì¸ë±ìŠ¤-ì„¤ì •ì„-ì¶”ê°€í•˜ì—¬-50-ms-ì´í•˜ë¡œ-ë°˜í™˜í•œë‹¤)
* [B. ì¸ë±ìŠ¤ ì„¤ê³„](#b-ì¸ë±ìŠ¤-ì„¤ê³„)
    * [B1 - Coding as a Hobby ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì„¸ìš”.](#b1---coding-as-a-hobby-ì™€-ê°™ì€-ê²°ê³¼ë¥¼-ë°˜í™˜í•˜ì„¸ìš”)
    * [B2 - í”„ë¡œê·¸ë˜ë¨¸ë³„ë¡œ í•´ë‹¹í•˜ëŠ” ë³‘ì› ì´ë¦„ì„ ë°˜í™˜í•˜ì„¸ìš”.](#b2---í”„ë¡œê·¸ë˜ë¨¸ë³„ë¡œ-í•´ë‹¹í•˜ëŠ”-ë³‘ì›-ì´ë¦„ì„-ë°˜í™˜í•˜ì„¸ìš”)
    * [B3 - í”„ë¡œê·¸ë˜ë°ì´ ì·¨ë¯¸ì¸ í•™ìƒ í˜¹ì€ ì£¼ë‹ˆì–´(0-2ë…„)ë“¤ì´ ë‹¤ë‹Œ ë³‘ì› ì´ë¦„ì„ ë°˜í™˜í•˜ê³  user.id ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì„¸ìš”.](#b3---í”„ë¡œê·¸ë˜ë°ì´-ì·¨ë¯¸ì¸-í•™ìƒ-í˜¹ì€-ì£¼ë‹ˆì–´0-2ë…„ë“¤ì´-ë‹¤ë‹Œ-ë³‘ì›-ì´ë¦„ì„-ë°˜í™˜í•˜ê³ -userid-ê¸°ì¤€ìœ¼ë¡œ-ì •ë ¬í•˜ì„¸ìš”)
    * [B4 - ì„œìš¸ëŒ€ë³‘ì›ì— ë‹¤ë‹Œ 20ëŒ€ India í™˜ìë“¤ì„ ë³‘ì›ì— ë¨¸ë¬¸ ê¸°ê°„ë³„ë¡œ ì§‘ê³„í•˜ì„¸ìš”.](#b4---ì„œìš¸ëŒ€ë³‘ì›ì—-ë‹¤ë‹Œ-20ëŒ€-india-í™˜ìë“¤ì„-ë³‘ì›ì—-ë¨¸ë¬¸-ê¸°ê°„ë³„ë¡œ-ì§‘ê³„í•˜ì„¸ìš”)
    * [B5 - ì„œìš¸ëŒ€ë³‘ì›ì— ë‹¤ë‹Œ 30ëŒ€ í™˜ìë“¤ì„ ìš´ë™ íšŸìˆ˜ë³„ë¡œ ì§‘ê³„í•˜ì„¸ìš”.](#b5---ì„œìš¸ëŒ€ë³‘ì›ì—-ë‹¤ë‹Œ-30ëŒ€-í™˜ìë“¤ì„-ìš´ë™-íšŸìˆ˜ë³„ë¡œ-ì§‘ê³„í•˜ì„¸ìš”)

## ë“¤ì–´ê°€ê¸°ì— ì•ì„œ
[ì‹¤ìŠµì‚¬ì´íŠ¸](https://www.w3schools.com/sql/trymysql.asp?filename=trysql_func_mysql_concat)ì—ì„œ ì•„ë˜ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì.

ì‹¤ìŠµ ê´€ë ¨ ìˆ˜í–‰ ê³¼ì •ì€ [ì‹¤ìŠµ ê³¼ì • ì •ë¦¬](./ì‹¤ìŠµ-ê³¼ì •-ì •ë¦¬.md)ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆì–´ìš”!

### ì‹¤ìŠµ 1ë²ˆ
200ê°œ ì´ìƒ íŒ”ë¦° ìƒí’ˆëª…ê³¼ ê·¸ ìˆ˜ëŸ‰ì„ ìˆ˜ëŸ‰ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ë³´ì—¬ì£¼ì„¸ìš”.

```sql
select p.ProductID as 'ìƒí’ˆì•„ì´ë””', p.ProductName as 'ìƒí’ˆì´ë¦„', sum(od.Quantity) as 'ì´ìˆ˜ëŸ‰'
from Products p, OrderDetails od
where p.ProductID = od.ProductID
group by p.ProductID
having `ì´ìˆ˜ëŸ‰` >= 200
order by `ì´ìˆ˜ëŸ‰` desc;
```

### ì‹¤ìŠµ 2ë²ˆ
ë§ì´ ì£¼ë¬¸í•œ ìˆœìœ¼ë¡œ ê³ ê° ë¦¬ìŠ¤íŠ¸(ID, ê³ ê°ëª…)ë¥¼ êµ¬í•´ì£¼ì„¸ìš”. (ê³ ê°ë³„ êµ¬ë§¤í•œ ë¬¼í’ˆ ì´ ê°¯ìˆ˜)

```sql
select c.CustomerID as 'ê³ ê°ì•„ì´ë””', c.CustomerName as 'ê³ ê°ì´ë¦„', sum(od.Quantity) as 'ì£¼ë¬¸ëŸ‰'
from Orders o, Customers c, OrderDetails od
where o.CustomerID = c.CustomerID 
and o.OrderID = od.OrderID
group by c.CustomerID
order by `ì£¼ë¬¸ëŸ‰` desc;
```

### ì‹¤ìŠµ 3ë²ˆ
ë§ì€ ëˆì„ ì§€ì¶œí•œ ìˆœìœ¼ë¡œ ê³ ê° ë¦¬ìŠ¤íŠ¸ë¥¼ êµ¬í•´ì£¼ì„¸ìš”.

```sql
select c.CustomerID as 'ê³ ê°ì•„ì´ë””', c.CustomerName as 'ê³ ê°ì´ë¦„', sum(od.Quantity*p.Price) as 'ì§€ì¶œê¸ˆì•¡'
from Orders o, Customers c, Products p, OrderDetails od
where o.CustomerID = c.CustomerID 
and o.OrderID = od.OrderID
and od.ProductID = p.ProductID
group by c.CustomerID
order by `ì§€ì¶œê¸ˆì•¡` desc;
```

## A. ì¿¼ë¦¬ ì—°ìŠµ
í™œë™ì¤‘ì¸(Active) ë¶€ì„œì˜ í˜„ì¬ ë¶€ì„œê´€ë¦¬ì ì¤‘ ì—°ë´‰ ìƒìœ„ 5ìœ„ì•ˆì— ë“œëŠ” ì‚¬ëŒë“¤ì´ ìµœê·¼ì— ê° ì§€ì—­ë³„ë¡œ ì–¸ì œ í‡´ì‹¤í–ˆëŠ”ì§€ ì¡°íšŒí•´ë³´ì„¸ìš”.  
(ì‚¬ì›ë²ˆí˜¸, ì´ë¦„, ì—°ë´‰, ì§ê¸‰ëª…, ì§€ì—­, ì…ì¶œì…êµ¬ë¶„, ì…ì¶œì…ì‹œê°„)  
ê¸‰ì—¬ í…Œì´ë¸”ì˜ ì‚¬ìš©ì—¬ë¶€ í•„ë“œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í˜„ì¬ ê·¼ë¬´ì¤‘ì¸ì§€ ì—¬ë¶€ëŠ” ì¢…ë£Œì¼ì í•„ë“œë¡œ íŒë‹¨í•´ì£¼ì„¸ìš”.

### A1 - ì¿¼ë¦¬ ì‘ì„±ë§Œìœ¼ë¡œ 1s ì´í•˜ë¡œ ë°˜í™˜í•œë‹¤.

```sql
select ì—°ë´‰ìƒìœ„5ìœ„.ì‚¬ì›ë²ˆí˜¸, ì—°ë´‰ìƒìœ„5ìœ„.ì´ë¦„, ì—°ë´‰ìƒìœ„5ìœ„.ì—°ë´‰, ì—°ë´‰ìƒìœ„5ìœ„.ì§ê¸‰ëª…, ì‚¬ì›ì¶œì…ê¸°ë¡.ì…ì¶œì…ì‹œê°„, ì‚¬ì›ì¶œì…ê¸°ë¡.ì§€ì—­, ì‚¬ì›ì¶œì…ê¸°ë¡.ì…ì¶œì…êµ¬ë¶„
from ì‚¬ì›ì¶œì…ê¸°ë¡,
     (select ë¶€ì„œê´€ë¦¬ì.ì‚¬ì›ë²ˆí˜¸ as 'ì‚¬ì›ë²ˆí˜¸', ì‚¬ì›.ì´ë¦„ as 'ì´ë¦„', ê¸‰ì—¬.ì—°ë´‰ as 'ì—°ë´‰', ì§ê¸‰.ì§ê¸‰ëª… as 'ì§ê¸‰ëª…'
      from ë¶€ì„œê´€ë¦¬ì
             inner join ë¶€ì„œ on ë¶€ì„œê´€ë¦¬ì.ë¶€ì„œë²ˆí˜¸ = ë¶€ì„œ.ë¶€ì„œë²ˆí˜¸
             inner join ì‚¬ì› on ë¶€ì„œê´€ë¦¬ì.ì‚¬ì›ë²ˆí˜¸ = ì‚¬ì›.ì‚¬ì›ë²ˆí˜¸
             inner join ê¸‰ì—¬ on ë¶€ì„œê´€ë¦¬ì.ì‚¬ì›ë²ˆí˜¸ = ê¸‰ì—¬.ì‚¬ì›ë²ˆí˜¸
             inner join ì§ê¸‰ on ë¶€ì„œê´€ë¦¬ì.ì‚¬ì›ë²ˆí˜¸ = ì§ê¸‰.ì‚¬ì›ë²ˆí˜¸
      where ë¶€ì„œ.ë¹„ê³  = 'active'
        and ë¶€ì„œê´€ë¦¬ì.ì¢…ë£Œì¼ì >= curdate()
        and ê¸‰ì—¬.ì¢…ë£Œì¼ì >= curdate()
        and ì§ê¸‰.ì¢…ë£Œì¼ì >= curdate()
      order by `ì—°ë´‰` desc
        limit 5) as ì—°ë´‰ìƒìœ„5ìœ„
where ì…ì¶œì…êµ¬ë¶„ = 'O'
  and ì‚¬ì›ì¶œì…ê¸°ë¡.ì‚¬ì›ë²ˆí˜¸ = ì—°ë´‰ìƒìœ„5ìœ„.ì‚¬ì›ë²ˆí˜¸
order by ì—°ë´‰ desc
;
```

* ì‹¤í–‰ ê²°ê³¼  
  <img src="/images/a1.png" width="900"/>

### A2 - ì¸ë±ìŠ¤ ì„¤ì •ì„ ì¶”ê°€í•˜ì—¬ 50 ms ì´í•˜ë¡œ ë°˜í™˜í•œë‹¤.
```sql
CREATE INDEX I_ì‚¬ì›ë²ˆí˜¸ ON tuning.ì‚¬ì›ì¶œì…ê¸°ë¡ (ì‚¬ì›ë²ˆí˜¸);
```

* ì‹¤í–‰ ê²°ê³¼  
  <img src="/images/a2.png" width="900"/>

* EC2ì— DBë¥¼ ì˜¬ë ¤ë†“ê³  ì—°ê²°í•´ì„œ ì‚¬ìš©í•˜ë‹¤ë³´ë‹ˆ ë„¤íŠ¸ì›Œí¬ì— ë”°ë¼ì„œ Durationì´ ì¼ì •í•˜ì§€ ì•Šë”ë¼êµ¬ìš”.. ğŸ˜

[ì§ˆë¬¸]  
1. ì…ì¶œì…êµ¬ë¶„ì˜ equal ì—°ì‚°ìë¡œ í•œë²ˆ ê±°ë¥´ê³ , ì‚¬ì›ë²ˆí˜¸ë„ equalë¡œ ê±°ë¥´ë‹ˆ (ì…ì¶œì…êµ¬ë¶„, ì‚¬ì›ë²ˆí˜¸)ì™€ ê°™ì€ í˜•íƒœë¡œ ì¸ë±ìŠ¤ë¥¼ ê±°ëŠ”ê²Œ ë” ì¢‹ì§€ ì•Šì„ê¹Œ? ë¼ëŠ” ìƒê°ì´
ë“¤ì—ˆì–´ìš”. ê·¼ë° ë³„ ì°¨ì´ê°€ ì—†ë”ë¼êµ¬ìš”? ì´ìœ ê°€ ë­˜ê¹Œìš”?

## B. ì¸ë±ìŠ¤ ì„¤ê³„
* ì¡°ê±´  
  ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì„ í™œìš©í•˜ì—¬ ì•„ë˜ ì¡°íšŒ ê²°ê³¼ë¥¼ 100ms ì´í•˜ë¡œ ë°˜í™˜

### B1 - Coding as a Hobby ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì„¸ìš”.

* programmer.idì— Unique PK ì§€ì •
* hobbyì— index ì§€ì •
* filesortì™€ ì„ì‹œ í…Œì´ë¸”ì„ ì—†ì• ê¸° ìœ„í•´ `order by percentage desc` -> `order by null`ë¡œ ë³€ê²½í•´ë³´ì•˜ëŠ”ë°, ê·¸ë ‡ê²Œ ë§ì€ ì°¨ì´ê°€ ë‚˜ì§€ ì•Šì•„ 
  ìš°ì„  Yesê°€ ìœ„ì— ë‚˜ì˜¤ë„ë¡ `order by percentage desc`ë¥¼ ìœ ì§€í–ˆìŠµë‹ˆë‹¤.

```sql
CREATE INDEX I_hobby ON subway.programmer (hobby);

select hobby as 'coding as a hobby', round((count(id) * 100 / (select count(*) from subway.programmer)), 1) as 'percentage'
from subway.programmer
group by hobby
order by percentage desc;
```

* ì‹¤í–‰ ê²°ê³¼  
  <img src="/images/b1.png" width="900"/>

* Duration: 0.051sec


### B2 - í”„ë¡œê·¸ë˜ë¨¸ë³„ë¡œ í•´ë‹¹í•˜ëŠ” ë³‘ì› ì´ë¦„ì„ ë°˜í™˜í•˜ì„¸ìš”.
* (covid.id, hospital.name)  


### B3 - í”„ë¡œê·¸ë˜ë°ì´ ì·¨ë¯¸ì¸ í•™ìƒ í˜¹ì€ ì£¼ë‹ˆì–´(0-2ë…„)ë“¤ì´ ë‹¤ë‹Œ ë³‘ì› ì´ë¦„ì„ ë°˜í™˜í•˜ê³  user.id ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì„¸ìš”.
* (covid.id, hospital.name, user.Hobby, user.DevType, user.YearsCoding)  

### B4 - ì„œìš¸ëŒ€ë³‘ì›ì— ë‹¤ë‹Œ 20ëŒ€ India í™˜ìë“¤ì„ ë³‘ì›ì— ë¨¸ë¬¸ ê¸°ê°„ë³„ë¡œ ì§‘ê³„í•˜ì„¸ìš”.
* (covid.Stay)  

### B5 - ì„œìš¸ëŒ€ë³‘ì›ì— ë‹¤ë‹Œ 30ëŒ€ í™˜ìë“¤ì„ ìš´ë™ íšŸìˆ˜ë³„ë¡œ ì§‘ê³„í•˜ì„¸ìš”.
* (user.Exercise)  
